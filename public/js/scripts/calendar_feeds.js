timely.define(["jquery_timely","domReady","scripts/calendar_feeds/ics/ics_event_handlers","libs/select2_multiselect_helper","libs/tags_select","libs/utils","ai1ec_config","libs/gmaps","external_libs/jquery_cookie","external_libs/bootstrap/tab","external_libs/bootstrap/alert","external_libs/bootstrap/modal","external_libs/bootstrap/button","external_libs/bootstrap/collapse"],function(e,t,n,r,i,s,o,u){var a=function(){var t=e(this.hash);r.refresh(t),i.refresh(t)},f=function(t){var n=e(this).attr("href");e.cookie("feeds_active_tab",n)},l=function(){var t=e("#ai1ec-feeds-after"),s=e(".ai1ec_submit_wrapper"),o=e(".ai1ec_file_upload_tags_categories");r.init(t),i.init(t),r.init(s),i.init(s),r.init(o),i.init(o),e("ul.ai1ec-nav a").on("click",f),e("ul.ai1ec-nav a").on("shown",a),e('select[name="cron_freq"]').on("change",function(){e.ajax({url:ajaxurl,type:"POST",data:{action:"ai1ec_feeds_page_post",cron_freq:this.value}})}),e("#ai1ec-ics-modal").on("click",".remove, .keep",n.submit_delete_modal),e(document).on("click","#ai1ec_add_new_ics",n.add_new_feed).on("click",".ai1ec_delete_ics",n.open_delete_modal).on("click",".ai1ec_update_ics",n.update_feed).on("click",".ai1ec_edit_ics",n.edit_feed).on("click","#ai1ec_cancel_ics",n.edit_cancel).on("click",".ai1ec-panel-heading > a",n.edit_cancel).on("blur","#ai1ec_feed_url",n.feed_url_change)},c=function(){e(document).on("click",".ai1ec-suggested-import-event",function(){var t=e(this),n=t.closest(".ai1ec-suggested-event-import"),r=t.closest(".ai1ec-infowindow, tr").attr("data-event-id");return e("a.ai1ec-suggested-processing",n).removeClass("ai1ec-hidden"),t.addClass("ai1ec-hidden"),e.ajax({url:o.ajax_url,type:"POST",data:{action:"ai1ec_import_suggested_event",ai1ec_event_id:r},success:function(t){e("a.ai1ec-suggested-processing",n).addClass("ai1ec-hidden"),e("a.ai1ec-suggested-remove-event",n).removeClass("ai1ec-hidden")}}),!1}),e(document).on("click",".ai1ec-suggested-remove-event",function(){var t=e(this),n=t.closest(".ai1ec-suggested-event-import"),r=t.closest(".ai1ec-infowindow, tr").attr("data-event-id");return e("a.ai1ec-suggested-processing",n).removeClass("ai1ec-hidden"),t.addClass("ai1ec-hidden"),e.ajax({url:o.ajax_url,type:"POST",data:{action:"ai1ec_remove_suggested_event",ai1ec_event_id:r},success:function(t){e("a.ai1ec-suggested-processing",n).addClass("ai1ec-hidden"),e("a.ai1ec-suggested-import-event",n).removeClass("ai1ec-hidden")}}),!1});var t=function(){var t=e("tr.ai1ec-suggested-event"),n=[],r=new google.maps.LatLngBounds;map_options={mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!0,zoomControl:!0,scaleControl:!0},buttons=e(".ai1ec-suggested-events-actions-template").html(),events_map=new google.maps.Map(e("#ai1ec_events_map_canvas").get(0),map_options),infowindow=new google.maps.InfoWindow({maxWidth:260}),create_info=function(e){var t='<div class="ai1ec-infowindow" data-event-id="'+e.id+'"><a href="#" class="ai1ec-infowindow-title"><b>'+e.title+"</b></a><br>"+e.dtstart.substr(0,10)+" @ "+e.venue_name+"<br>"+buttons+"</div>";infowindow.setContent(t)},t.each(function(){var t=e(this),i=e.parseJSON(t.attr("data-event"));if(!i||!i.latitude||!i.longitude)return;var s=new google.maps.Marker({map:events_map,title:i.title,position:new google.maps.LatLng(i.latitude,i.longitude)});s.addListener("click",function(){create_info(i),infowindow.open(events_map,this)}),r.extend(s.getPosition()),n.push(s)}),events_map.fitBounds(r)};e(document).on("click",".ai1ec-suggested-view-list",function(){return e(this).hasClass("ai1ec-active")?!1:(e(".ai1ec-suggested-map-container").addClass("ai1ec-hidden"),e(".ai1ec-suggested-events").removeClass("ai1ec-hidden"),e(".ai1ec-suggested-view-selector .ai1ec-active").removeClass("ai1ec-active"),e(this).addClass("ai1ec-active"),!1)}),e(document).on("click",".ai1ec-suggested-view-map",function(){return e(this).hasClass("ai1ec-active")?!1:(e(".ai1ec-suggested-map-container").removeClass("ai1ec-hidden"),e(".ai1ec-suggested-events").addClass("ai1ec-hidden"),e(".ai1ec-suggested-view-selector .ai1ec-active").removeClass("ai1ec-active"),e(this).addClass("ai1ec-active"),e(this).attr("data-ai1ec-gmaps")||(u(t),e(this).attr("data-ai1ec-gmaps",1)),!1)})},h=function(){t(function(){s.activate_saved_tab_on_page_load(e.cookie("feeds_active_tab")),l(),c()})};return{start:h}});